subject cryptographi faq product cipher archiv name cryptographi faq part last modifi faq for sci crypt part product cipher thi is the fifth of ten part of the sci crypt faq the part ar mostli independ but you should read the first part befor the rest we don t have the time to send out miss part by mail so don t ask note such as kah refer to the refer list in the last part the section of thi faq ar avail via anonym ftp to rtfm mit edu as pub usenet new answer cryptographi faq part xx the cryptographi faq is post to the newsgroup sci crypt sci answer and new answer everi dai content what is a product cipher what make a product cipher secur what ar some group theoret properti of product cipher what can be proven about the secur of a product cipher how ar block cipher us to encrypt data longer than the block size can symmetr block cipher be us for messag authent what exactli is de what is tripl de what is differenti cryptanalysi how wa nsa involv in the design of de is de avail in softwar is de avail in hardwar can de be us to protect classifi inform what ar ecb cbc cfb and ofb encrypt what is a product cipher a product cipher is a block cipher that iter sever weak oper such as substitut transposit modular addit multipl and linear transform a block cipher just mean a cipher that encrypt a block of data byte sai all at onc then goe on to the next block the notion of product cipher is due to shannon sha exampl of modern product cipher includ lucif sor de nb sp network kam loki bro feal shi pe lai khufu and khafr me a the so call feistel cipher ar a class of product cipher which oper on on half of the ciphertext at each round and then swap the ciphertext halv after each round lucif de loki and feal ar exampl of feistel cipher the follow tabl compar the main paramet of sever product cipher cipher block length kei bit number of round lucif de loki feal x x pe what make a product cipher secur nobodi know how to prove mathemat that a product cipher is complet secur so in practic on begin by demonstr that the cipher look highli random for exampl the cipher must be nonlinear and it must produc ciphertext which function depend on everi bit of the plaintext and the kei meyer mei ha shown that at least round of de ar requir to guarante such a depend in thi sens a product cipher should act as a mix function which combin the plaintext kei and ciphertext in a complex nonlinear fashion the fix per round substitut of the product cipher ar refer to as s box for exampl lucif ha s box and de ha s box the nonlinear of a product cipher reduc to a care design of these s box a list of partial design criteria for the s box of de which appli to s box in gener mai be found in brown bro and brickel et al bri what ar some group theoret properti of product cipher let e be a product cipher that map n bit block to n bit block let e k x be the encrypt of x under kei k then for ani fix k the map send x to e k x is a permut of the set of n bit block denot thi permut by p k the set of all n bit permut is call the symmetr group and is written s n the collect of all these permut p k where k rang over all possibl kei is denot e s n if e were a random map from plaintext to ciphertext then we would expect e s n to gener a larg subset of s n coppersmith and grossman cop have shown that a veri simpl product cipher can gener the altern group a n given a suffici number of round the altern group is half of the symmetr group it consist of all even permut i e all permut which can be written as an even number of swap even and goldreich ev were abl to extend these result to show that feistel cipher can gener a n given a suffici number of round the secur of multipl encipher also depend on the group theoret properti of a cipher multipl encipher is an extens over singl encipher if for kei k k there doe not exist a third kei k such that e k e k x e k x which indic that encrypt twice with two independ kei k k is equal to a singl encrypt under the third kei k if for everi k k there exist a k such that eq is true then we sai that e is a group thi question of whether de is a group under thi definit wa extens studi by sherman kaliski and rivest she in their paper thei give strong evid for the hypothesi that de is not a group in fact de is not a group cam what can be proven about the secur of a product cipher recal from abov that p k is a permut produc by e under some kei k the goal of the design of e is to ensur that p k appear to be a random element of s n the symmetr group let r be an element of s n select randomli we will sai that p k and r ar indistinguish if an observ given p k and r in some order cannot distinguish between these two permut in polynomi time that is with time bound resourc the observ cannot determin which of the permut is produc by e the optim decis is no better than simpli guess lubi and rackoff lub have shown that a class of feistel cipher ar secur in thi sens when the round map is replac by random boolean function how ar block cipher us to encrypt data longer than the block size there ar four standard mode of oper and numer non standard on as well the standard mode of oper ar defin in the u s depart of commerc feder inform process standard fip publish in see the question about ecb below for more detail although thei ar defin for the de block cipher the mode of oper can be us with ani block cipher can symmetr block cipher be us for messag authent on mai us a symmetr cryptosystem block cipher to prove to himself that he did or did not gener a messag and to prove to himself whether hi messag wa alter or unalt sinc gener but on cannot prove these thing to anoth without reveal the kei and thereaft that kei cannot be us to prove anyth about ani messag that were authent us that kei see ansi x and fip for a standard method of messag authent us de what exactli is de de is the u s govern s data encrypt standard a product cipher that oper on bit block of data us a bit kei it is defin in fip which supersed fip fip ar feder inform process standard publish by nti de is ident to the ansi standard data encrypt algorithm dea defin in ansi x what is tripl de tripl de is a product cipher which like de oper on bit data block there ar sever form each of which us the de cipher time some form us two bit kei some us three the de mode of oper mai also be us with tripl de some peopl refer to e k d k e k x as tripl de thi method is defin in chapter of the ansi standard x financi institut kei manag and is intend for us in encrypt de kei and iv for autom kei distribut it formal name is encrypt and decrypt of a singl kei by a kei pair but it is referenc in other standard document as ed that standard sai section kei encrypt kei mai be a singl dea kei or a dea kei pair kei pair shoud be us where addit secur is need e g the data protect by the kei s ha a long secur life a kei pair shall not be encrypt or decrypt us a singl kei other us the term tripl de for e k d k e k x or e k e k e k x on of us carl ellison keep advoc de tripl us in the form e k tran e k tran e k compress x where each de instanc ha it own kei and iv for cbc mode and tran ha been post on sci crypt it is a larg block transposit program take it kei from the data stream itself so that it is not an encrypt program on it own part what is differenti cryptanalysi differenti cryptanalysi is a statist attack that can be appli to ani iter map ie ani map which is base on a repeat round function the method wa recent popular by biham and shamir bih but coppersmith ha remark that the s box of de were optim against thi attack some year ago thi method ha prove effect against sever product cipher notabl feal bi a differenti cryptanalysi is base on observ a larg number of ciphertext y y whose correspond plaintext x x satisfi a known differ d x x where is componentwis xor in the basic biham shamir attack such plaintext pair ar requir to determin the kei for de substanti fewer pair ar requir if de is truncat to or round in these case the actual kei can be recov in a matter of minut us a few thousand pair for full de thi attack is impract becaus it requir so mani known plaintext the work of biham and shamir on de reveal sever startl observ on the algorithm most importantli if the kei schedul wa remov from de and a bit kei wa us the kei could be recov in less than step thu independ subkei do not add substanti secur to de further the s box of de ar extrem sensit in that chang even singl entri in these tabl yield signific improv in the differenti attack adi shamir is quot to sai nytim oct i would sai that contrari to what some peopl believ there is no evid of tamper with the de so that the basic design wa weaken how wa nsa involv in the design of de accord to kinnucan kin tuchman a member of the group that develop de at ibm is quot as sai we develop the de algorithm entir within ibm us ibmer the nsa did not dictat a singl wire tuchman and meyer anoth develop of de spent a year break cipher and find weak in lucif thei then spent two year strengthen lucif their basic approach wa to look for strong substitut permut and kei schedul function ibm ha classifi the note contain the select criteria at the request of the nsa the nsa told us we had inadvert reinvent some of the deep secret it us to make it own algorithm explain tuchman on the other hand a document call involv of the nsa in the develop of de unclassifi summari of the unit state select committe on intellig print in the ieee commun magazin p state in the develop of de nsa convinc ibm that a reduc keysiz wa suffici indirectli assist in the develop of the s box structur and certifi that the final de algorithm wa to the best of their knowledg free from ani statist or mathemat weak clearli the kei size wa reduc at the insist of the nsa the articl further state that the nsa did not tamper with the algorithm itself just the paramet which in some sens resolv the appar conflict in the remark of meyer and tuchman present abov is de avail in softwar sever peopl have made de code avail via ftp see part for pathnam stig ostholm ftpso bsd ftpbk eric young ftpei denni furguson ftpdf mark riordan ftpmr phil karn ftppk a pascal list of de is also given in patterson pat fip sai the algorithm specifi in thi standard is to be implement us hardwar not softwar technolog softwar implement in gener purpos comput ar not in complianc with thi standard despit thi softwar implement abound and ar us by govern agenc is de avail in hardwar the follow paragraph ar quot from messag sent to the editor we don t vouch for the qualiti or even exist of the product chip rosenth sai dalla semiconductor make a de encrypt decrypt devic for us on standard digit kbp pcm telecom data stream it is capabl of process data in real time e g on sampl frame it is the ds their phone number is you would probabl need to talk with dewight in telecom market christian frank frank informatik rwth aachen de sai cryptech cry c mbit s accord to data sheet with bit interfac we us thi on becaus it wa the onli on avail when we start the project no problem pijnenburg pcc mbit s accord to data sheet address pijnenburg b v boxtelswweg nl ne vught the netherland infosi de chip germani s box must be load by softwar so you can modifi the algorithm sorri i don t have the data sheet handi pleas e mail me if you need further inform mjr ti com marcu j ranum sai supercrypt mb sec and faster de and proprietari storag for bit kei kei stream gener integr hardwar de procedur extend mode with bit kei comput elektronik infosi a herndon parkwai herndon va thember gandalf ca tim hember sai newbridg microsystem sell an am compat de chip that oper at mhz perform a round of encrypt in clock ha a three stage pipelin support ecb cbc cfb and cfb further it is veri reason price as oppos to other high end de chip call newbridg microsystem ottawa there ar no import export issu with canada and the us if you requir custom de or public kei ic then timestep engin develop newbridg s crypto chip and ic for other commerci and educ establish thei can be reach at can de be us to protect classifi inform de is not intend to protect classifi data fip sai thi standard will be us by feder depart and agenc for the cryptograph protect of comput data when the follow condit appli cryptograph protect is requir and the data is not classifi accord to the nation secur act of as amend or the atom energi act of as amend what ar ecb cbc cfb and ofb encrypt these ar method for us block cipher such as de to encrypt messag file and block of data known as mode of oper four mode of oper ar defin in fip decemb and also in ansi x fip specifi that when bit ascii data is sent in octet the unus most signific bit is to be set to fip also specifi the pad for short block the four de mode of oper ar electron code book ecb cipher block chain cbc k bit cipher feedback cfb and k bit output feedback ofb these method ar explain below in a c languag like notat some symbol p n the n th block of plaintext input to encrypt output from decrypt size of block determin by the mode c n the n th block of ciphertext output from encrypt input to decrypt size of block determin by the mode e m the de encrypt function perform on bit block m us the kei schedul deriv from some bit kei d m the de decrypt function perform on bit block m us the same kei schedul as in e m except that the kei in the schedul ar us in the opposit order as in e m iv a bit initi vector a secret valu which along with the kei is share by both encryptor and decryptor i n the n th valu of a bit variabl us in some mode r n the n th valu of a bit variabl us in some mode lsb m k the k least signific right most bit of m e g m k msb m k the k most signific left most bit of m e g m k k oper as defin in the c langag electron code book ecb p n and c n ar each bit long encrypt decrypt c n e p n p n d c n cipher block chain cbc p n and c n ar each bit long encrypt decrypt c e p iv p d c iv n c n e p n c n p n d c n c n k bit cipher feedback cfb p n and c n ar each k bit long k encrypt decrypt i iv i iv n i n i n k c n i n i n k c n all n r n msb e i n k r n msb e i n k all n c n p n r n p n c n r n note that for k thi reduc to i iv i iv n i n c n i n c n all n r n e i n r n e i n all n c n p n r n p n c n r n cfb note sinc i n depend onli on the plain or cipher text from the previou oper the e function can be perform in parallel with the recept of the text with which it is us k bit output feedback ofb p n and c n ar each k bit long k encrypt decrypt i iv i iv n i n i n k r n i n i n k r n all n r n msb e i n k r n msb e i n k all n c n p n r n p n c n r n note that for k thi reduc to i iv i iv n i n r n i n r n all n r n e i n r n e i n all n c n p n r n p n c n r n ofb note encrypt and decrypt ar ident sinc i n is independ of p and c the e function can be perform in advanc of the receipt of the plain cipher text with which it is to be us addit note on de mode of oper ecb and cbc us e to encrypt and d to decrypt but the feedback mode us e to both encrypt and decrypt thi disprov the erron claim that system which featur e but not d cannot be us for data confidenti and therefor ar not subject to export control 